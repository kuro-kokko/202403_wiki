# 202403_wiki
## はじめに
ローカル環境構築やgithub pagesへのデプロイは少し出来るようになってきたので、今回はリモートサーバーへのデプロイに挑戦しました。  
成果物を公開出来るようになるまでの手順や作業時に得た知見、その他個人的なメモ等をまとめました。  
今回作成したWikiは[こちら](https://testwiki.kurokokko.com/ja/home)  
環境構築手順のページは[こちら](https://testwiki.kurokokko.com/ja/how-to-setup)  

## 目的
- wiki形式の成果物をリモートサーバー上で公開する。
  - 成果物＝ナレッジ・簡易手順書のため、wiki形式だと追加編集の実施が容易のため便利
- セキュリティ関連の設定について調査し実施する。
  - SSL化、ファイアウォール等の設定方法を学ぶ

## 使用したもの（システム構成）
- AWS EC2
  - 業務でもよく使用している
  - 無料枠があるので手軽に試せる
- AWS Route53
  - 独自ドメイン設定用
- Nginx
  - Webサーバ、リバースプロキシ設定用
- Wiki.js
  - 無料かつ多機能が備わっている
    - Markdownやリッチテキスト等エディターを選択でき、デフォルトのデザインが良い感じなのでカスタム無しでも使える
  - 外部サービスでログイン可能
    - Github, Google, MSアカウント等での認証が可能のためプロジェクトWikiとしての運用も容易
  - Dockerイメージが用意されておりデプロイが容易
    - 難しい作業が不要のため気軽に試せる
- PostgreSQL
  - Wiki.jsのDB
 
## できたこと
- EC2上で動作するシステムの構築
    - HTTPS対応、独自ドメインの設定を含む
- リモート環境の作成・構築

## できなかったこと
- CI/CD対応
    - 現時点では必要ではないが、Wiki.jsのバージョンアップ等を想定する場合あった方が便利
- VPCの設定
    - 複数インスタンスを使用して可用性を重視した運用をしたり、保守性を高めたり、セキュリティ面を強化するために必要
        - 今回は個人で使用し、1～2ヶ月程度でクローズする環境のため優先度を下げていた

## 総括
- インスタンスを立ててからデプロイまで予定より時間は掛からなかったが、セキュリティ面が良いとは言えない状態のためより踏み込んだ設定が必要だと感じた。
    - デプロイまでがほぼ無料＋簡単な手順で達成出来てしまう反面、セキュリティ面の設定はHTTPS化ですら多少お金が掛かってしまうので
    セキュリティの穴が発生してしまいがちなのかもしれない、とも感じた
- 事前に設定ファイルを準備しておくことのメリットは大きいと感じた。併せて設計段階での最適化の重要性を感じた。
    - リモート上での作業を極力減らすことで、手順ミスを減らせるため無いよりはあった方が絶対に良いと考えている
    - サーバー複数台に構築する際も便利であり、実用的な手法だと思う
- 今回は個人的なカスタムをせずにEC2と公式のDockerイメージを利用して環境構築を行ったが、様々なユーザの要件を想定して適切なカスタムが行えるべきだと感じた。
    - 普段から利用しているからという理由でEC2に拘るべきではない
    - 今回の場合はDockerをECR+ECSの方が適切だと思うので、今後機会があればその構成にもチャレンジしてみたい。
